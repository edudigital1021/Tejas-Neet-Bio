<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEJAS NEET BIO PYQ - Google Auth Edition</title>
    <!-- Essential CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
            overflow-x: hidden; 
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Speed Optimization: Remove all animations between questions */
        .question-card, .option-btn { 
            transition: none !important; 
            animation: none !important;
        }

        .btn-active:active { transform: scale(0.96); }
        .lucide { vertical-align: middle; }

        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        indigo: { 50: '#eef2ff', 100: '#e0e7ff', 200: '#c7d2fe', 300: '#a5b4fc', 400: '#818cf8', 500: '#6366f1', 600: '#4f46e5', 700: '#4338ca', 800: '#3730a3', 900: '#312e81' }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-slate-100 transition-colors duration-300">
    <div id="root"></div>

    <!-- Firebase SDK Modular -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, doc } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-firestore.js";

        window.FirebaseAPI = { 
            initializeApp, getAuth, GoogleAuthProvider, signInWithPopup, 
            onAuthStateChanged, signOut, getFirestore, collection, 
            addDoc, onSnapshot, serverTimestamp, query, doc 
        };
    </script>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyBYclFi9AIsR5HB6FvGbJCc2Ed6x3Nguv0",
            authDomain: "tejas-neet-bio.firebaseapp.com",
            projectId: "tejas-neet-bio",
            storageBucket: "tejas-neet-bio.firebasestorage.app",
            messagingSenderId: "359240762418",
            appId: "1:359240762418:web:4fe49fd69019605ea1682b"
        };

        const CHAPTER_DATA = {
            "11": ["The Living World", "Biological Classification", "Plant Kingdom", "Animal Kingdom", "Morphology of Flowering Plants", "Anatomy of Flowering Plants", "Structural Organisation in Animals", "Cell: The Unit of Life", "Biomolecules", "Cell Cycle and Cell Division", "Photosynthesis in Higher Plants", "Respiration in Plants", "Plant Growth and Development", "Breathing and Exchange of Gases", "Body Fluids and Circulation", "Excretory Products and their Elimination", "Locomotion and Movement", "Neural Control and Coordination", "Chemical Coordination and Integration"],
            "12": ["Sexual Reproduction in Flowering Plants", "Human Reproduction", "Reproductive Health", "Principles of Inheritance and Variation", "Molecular Basis of Inheritance", "Evolution", "Human Health and Disease", "Microbes in Human Welfare", "Biotechnology: Principles and Processes", "Biotechnology and its Applications", "Organisms and Populations", "Ecosystem", "Biodiversity and Conservation"]
        };

        const ALL_CHAPTER_LIST = ["All Chapters", ...CHAPTER_DATA["11"], ...CHAPTER_DATA["12"]];
        const YEAR_RANGE = Array.from({ length: 16 }, (_, i) => 2010 + i);

        const ALL_QUESTIONS = [
            { id: 1, question: "Which of the following is responsible for peat formation?", options: ["Marchantia", "Riccia", "Funaria", "Sphagnum"], correctAnswer: 3, year: 2014, chapter: "Plant Kingdom", classLevel: "11", topic: "Bryophytes", solution: "Sphagnum (Peat moss) is used as fuel and packing material." },
            { id: 2, question: "Select the wrong statement regarding Diatoms.", options: ["Walls are easily destructible", "Form diatomaceous earth", "Chief producers in oceans", "Float passively in water"], correctAnswer: 0, year: 2016, chapter: "Biological Classification", classLevel: "11", topic: "Chrysophytes", solution: "Diatom walls are indestructible due to silica deposition." },
            { id: 3, question: "In the above represented plasmid an alien piece of DNA is inserted at EcoRI site. Which strategy selects recombinant colonies?", options: ["White color colonies", "Blue colonies on ampicillin", "Ampicillin & tetracycline plate", "Blue colonies"], correctAnswer: 0, year: 2025, chapter: "Biotechnology", classLevel: "12", topic: "Recombinant DNA", solution: "Insertional inactivation leads to white colonies." },

{ id: 4, question: "The protein portion of an enzyme is called:", options: ["Apoenzyme", "Prosthetic group", "Cofactor", "Coenzyme"], correctAnswer: 0, year: 2025, chapter: "Biomolecules", classLevel: "11", topic: "Enzymes", solution: "Protein part is called apoenzyme." },

{ id: 5, question: "Primary source of energy in ecosystem & NPP definition correct option?", options: ["I true II false", "I false II true", "Both true", "Both false"], correctAnswer: 0, year: 2025, chapter: "Ecosystem", classLevel: "12", topic: "Productivity", solution: "NPP ≠ total photosynthesis." },

{ id: 6, question: "Typical angiosperm embryo sac is:", options: ["A true R false", "A false R true", "Both true correct explanation", "Both true wrong explanation"], correctAnswer: 0, year: 2025, chapter: "Sexual Reproduction in Flowering Plants", classLevel: "12", topic: "Embryo sac", solution: "Egg apparatus has 3 cells not polar nuclei." },

{ id: 7, question: "Neoplastic characteristics include:", options: ["A,B,D", "B,C,D", "A,B", "A,B,C"], correctAnswer: 3, year: 2025, chapter: "Human Health and Disease", classLevel: "12", topic: "Cancer", solution: "Rapid growth & invasion present." },

{ id: 8, question: "Characteristic feature of gymnosperms:", options: ["Seeds absent", "Flowers present", "Seeds enclosed", "Naked seeds"], correctAnswer: 3, year: 2025, chapter: "Plant Kingdom", classLevel: "11", topic: "Gymnosperm", solution: "Seeds are naked." },

{ id: 9, question: "Hormone match correct:", options: ["a", "b", "c", "d"], correctAnswer: 2, year: 2025, chapter: "Chemical Coordination", classLevel: "11", topic: "Hormones", solution: "Progesterone corpus luteum etc." },

{ id: 10, question: "Chromosome with highest genes:", options: ["Chromosome1", "Chromosome10", "ChromosomeX", "ChromosomeY"], correctAnswer: 0, year: 2025, chapter: "Molecular Basis of Inheritance", classLevel: "12", topic: "Genome", solution: "Chr1 highest genes." },

{ id: 11, question: "RuBisCO true statement:", options: ["Photolysis", "Carboxylation RuBP", "Dark only", "Higher O2 affinity"], correctAnswer: 1, year: 2025, chapter: "Photosynthesis", classLevel: "11", topic: "Calvin Cycle", solution: "Carboxylates RuBP." },

{ id: 12, question: "First menstruation called:", options: ["Diapause", "Ovulation", "Menopause", "Menarche"], correctAnswer: 3, year: 2025, chapter: "Reproductive Health", classLevel: "12", topic: "Puberty", solution: "Menarche." },

{ id: 13, question: "Organism used by Eli Lilly to produce insulin:", options: ["Virus", "Phage", "Bacteria", "Yeast"], correctAnswer: 2, year: 2025, chapter: "Biotechnology", classLevel: "12", topic: "Insulin", solution: "E.coli used." },

{ id: 14, question: "All vertebrates chordates statement:", options: ["A true R false", "A false R true", "Both true correct", "Both true wrong"], correctAnswer: 2, year: 2025, chapter: "Animal Kingdom", classLevel: "11", topic: "Chordates", solution: "Correct explanation." },

{ id: 15, question: "Function of spindle fiber:", options: ["Repair DNA", "Regulate growth", "Separate chromosomes", "Synthesize DNA"], correctAnswer: 2, year: 2025, chapter: "Cell Cycle", classLevel: "11", topic: "Mitosis", solution: "Chromatid separation." },

{ id: 16, question: "Hershey Chase match:", options: ["a", "b", "c", "d"], correctAnswer: 0, year: 2025, chapter: "Molecular Basis", classLevel: "12", topic: "DNA proof", solution: "DNA genetic material." },

{ id: 17, question: "Adenosine Adenine match:", options: ["a", "b", "c", "d"], correctAnswer: 0, year: 2025, chapter: "Biomolecules", classLevel: "11", topic: "Nucleotides", solution: "Correct biochemical match." },

{ id: 18, question: "Frog renal portal system links:", options: ["Kidney intestine", "Kidney lower body", "Liver intestine", "Liver kidney"], correctAnswer: 1, year: 2025, chapter: "Structural Organisation Animals", classLevel: "11", topic: "Frog", solution: "Lower body connection." },

{ id: 19, question: "Post transcriptional events:", options: ["BCE", "CDE", "ABC", "BCD"], correctAnswer: 3, year: 2025, chapter: "Molecular Basis", classLevel: "12", topic: "RNA processing", solution: "Splicing capping tailing." },

{ id: 20, question: "PCR amplification equation:", options: ["2n+1", "2N2", "N2", "2n"], correctAnswer: 3, year: 2025, chapter: "Biotech Tools", classLevel: "12", topic: "PCR", solution: "2^n copies." },

{ id: 21, question: "Wind & water pollinated flowers statement correct?", options: ["A true R false", "A false R true", "Both true correct", "Both true wrong"], correctAnswer: 3, year: 2025, chapter: "Sexual Reproduction in Plants", classLevel: "12", topic: "Pollination", solution: "Reason true but not explanation." },

{ id: 22, question: "Epiphytes on mango branch example:", options: ["Predation", "Amensalism", "Commensalism", "Mutualism"], correctAnswer: 2, year: 2025, chapter: "Organisms and Populations", classLevel: "12", topic: "Ecological interactions", solution: "One benefited other unaffected." },

{ id: 23, question: "Human pregnancy correct statements:", options: ["BCDE", "ACDE", "AE", "BC"], correctAnswer: 1, year: 2025, chapter: "Human Reproduction", classLevel: "12", topic: "Pregnancy", solution: "Organs by 12 weeks." },

{ id: 24, question: "Foam breaker in bioreactor:", options: ["D", "C", "A", "B"], correctAnswer: 1, year: 2025, chapter: "Biotech Principles", classLevel: "12", topic: "Bioreactor", solution: "Part C foam breaker." },

{ id: 25, question: "Frog respiration statement:", options: ["False water true land", "False both", "True water false land", "True both"], correctAnswer: 0, year: 2025, chapter: "Structural Organisation Animals", classLevel: "11", topic: "Frog physiology", solution: "Buccal cavity not in water." },

{ id: 26, question: "Adrenal medulla functions:", options: ["ACD", "D", "CD", "BCD"], correctAnswer: 3, year: 2025, chapter: "Chemical Coordination", classLevel: "11", topic: "Adrenal gland", solution: "Hyperglycemic & piloerection." },

{ id: 27, question: "Plant growth development correct:", options: ["ADE", "BDE", "ABC", "ACE"], correctAnswer: 2, year: 2025, chapter: "Plant Growth", classLevel: "11", topic: "PGR", solution: "ABA inhibitor." },

{ id: 28, question: "Hormone synthesized in hypothalamus but released by pituitary:", options: ["FSH", "ACTH", "LH", "ADH"], correctAnswer: 3, year: 2025, chapter: "Neural Control", classLevel: "11", topic: "Hormones", solution: "ADH hypothalamus origin." },

{ id: 29, question: "Non distilled alcoholic beverage:", options: ["Beer", "Rum", "Whisky", "Brandy"], correctAnswer: 0, year: 2025, chapter: "Microbes in Human Welfare", classLevel: "12", topic: "Fermentation", solution: "Beer not distilled." },

{ id: 30, question: "Polygenic trait inheritance:", options: ["Autosomal dominant", "X-linked recessive", "Mendelian", "Non mendelian"], correctAnswer: 3, year: 2025, chapter: "Principles of Inheritance", classLevel: "12", topic: "Polygenic", solution: "Multiple genes." },

{ id: 31, question: "Sperm structure match:", options: ["a", "b", "c", "d"], correctAnswer: 2, year: 2025, chapter: "Human Reproduction", classLevel: "12", topic: "Gamete", solution: "Head DNA tail motility." },

{ id: 32, question: "Zygomorphic flower example:", options: ["Pea", "Chilli", "Petunia", "Datura"], correctAnswer: 0, year: 2025, chapter: "Morphology of Flowering Plants", classLevel: "11", topic: "Flower symmetry", solution: "Pea zygomorphic." },

{ id: 33, question: "Organism cannot fix nitrogen:", options: ["B only", "E only", "A only", "D only"], correctAnswer: 3, year: 2025, chapter: "Microbes", classLevel: "12", topic: "Nitrogen fixation", solution: "Volvox not fixer." },

{ id: 34, question: "Ex situ conservation example:", options: ["Zoo Botanical garden", "Protected area", "National park", "Wildlife sanctuary"], correctAnswer: 0, year: 2025, chapter: "Biodiversity", classLevel: "12", topic: "Conservation", solution: "Offsite conservation." },

{ id: 35, question: "Father of ecology in India:", options: ["Ram Udar", "Birbal Sahni", "S.R Kashyap", "Ramdeo Misra"], correctAnswer: 3, year: 2025, chapter: "Ecology", classLevel: "12", topic: "Scientists", solution: "Ramdeo Misra." },

{ id: 36, question: "RNA world & DNA evolution:", options: ["I true II false", "I false II true", "Both true", "Both false"], correctAnswer: 2, year: 2025, chapter: "Evolution", classLevel: "12", topic: "Origin of life", solution: "Both correct." },

{ id: 37, question: "tRNA rRNA interaction statement:", options: ["I true II false", "I false II true", "Both true", "Both false"], correctAnswer: 1, year: 2025, chapter: "Molecular Basis", classLevel: "12", topic: "RNAi", solution: "Statement I wrong." },

{ id: 38, question: "Organ hormone match:", options: ["a", "b", "c", "d"], correctAnswer: 1, year: 2025, chapter: "Chemical Coordination", classLevel: "11", topic: "Hormone sources", solution: "ANF heart." },

{ id: 39, question: "Cyclostomata members:", options: ["Symbiotic", "Ectoparasite", "Free living", "Endoparasite"], correctAnswer: 1, year: 2025, chapter: "Animal Kingdom", classLevel: "11", topic: "Cyclostomata", solution: "All ectoparasites." },

{ id: 40, question: "Streptokinase use:", options: ["Liver treatment", "Remove clots", "Curd", "Ethanol"], correctAnswer: 1, year: 2025, chapter: "Biotech Applications", classLevel: "12", topic: "Enzymes medicine", solution: "Clot buster." },

{ id: 41, question: "Water vascular system roles:", options: ["BC", "BDE", "AB", "AC"], correctAnswer: 3, year: 2025, chapter: "Animal Kingdom", classLevel: "11", topic: "Echinoderms", solution: "Respiration locomotion food." },

{ id: 42, question: "Plant group match:", options: ["a", "b", "c", "d"], correctAnswer: 3, year: 2025, chapter: "Plant Kingdom", classLevel: "11", topic: "Classification", solution: "Correct taxa." },

{ id: 43, question: "Cancer statements correct:", options: ["CD", "AC", "BD", "DE"], correctAnswer: 1, year: 2025, chapter: "Human Health", classLevel: "12", topic: "Cancer therapy", solution: "CT MRI detect." },

{ id: 44, question: "IVF drawbacks:", options: ["ABCD", "ABCEF", "BDF", "ACDF"], correctAnswer: 2, year: 2025, chapter: "Reproductive Health", classLevel: "12", topic: "IVF", solution: "Expensive & embryo risk." },

{ id: 45, question: "Gametogenesis statements:", options: ["BD", "BC", "AB", "AC"], correctAnswer: 2, year: 2025, chapter: "Human Reproduction", classLevel: "12", topic: "Gametogenesis", solution: "Females earlier meiosis." },

{ id: 46, question: "Gemmae function:", options: ["Nutrition", "Gas exchange", "Sexual reproduction", "Asexual reproduction"], correctAnswer: 3, year: 2025, chapter: "Plant Kingdom", classLevel: "11", topic: "Bryophyte", solution: "Asexual buds." },

{ id: 47, question: "Golgi apparatus assertion reason:", options: ["A true R false", "A false R true", "Both true correct", "Both true wrong"], correctAnswer: 2, year: 2025, chapter: "Cell Biology", classLevel: "11", topic: "Golgi", solution: "Packaging & vesicles." },

{ id: 48, question: "Reductionist biology:", options: ["Chemical", "Behavioural", "Physicochemical", "Physiological"], correctAnswer: 2, year: 2025, chapter: "Biology and Human Welfare", classLevel: "11", topic: "Approaches", solution: "Physicochemical." },

{ id: 49, question: "Secondary lymphoid organs:", options: ["EAB", "CDE", "BCD", "ABC"], correctAnswer: 1, year: 2025, chapter: "Human Health", classLevel: "12", topic: "Immune system", solution: "Spleen nodes Peyer." },

{ id: 50, question: "Biodiversity match:", options: ["a", "b", "c", "d"], correctAnswer: 3, year: 2025, chapter: "Biodiversity", classLevel: "12", topic: "Conservation terms", solution: "Correct match." },

{ id: 51, question: "Female gametophyte divisions:", options: ["1 meiosis 3 mitosis", "0 meiosis 2 mitosis", "2 meiosis 3 mitosis", "1 meiosis 2 mitosis"], correctAnswer: 0, year: 2025, chapter: "Sexual Reproduction Plants", classLevel: "12", topic: "Embryo sac", solution: "MMC meiosis then 3 mitosis." },

{ id: 52, question: "Innate immunity:", options: ["Cell mediated", "Humoral", "Acquired", "Innate"], correctAnswer: 3, year: 2025, chapter: "Human Health", classLevel: "12", topic: "Immunity", solution: "Present at birth." },

{ id: 53, question: "Fig fruit statements:", options: ["I true II false", "I false II true", "Both true", "Both false"], correctAnswer: 3, year: 2025, chapter: "Ecology", classLevel: "12", topic: "Mutualism", solution: "Both incorrect." },

{ id: 54, question: "Tapetum assertion reason:", options: ["A true R false", "A false R true", "Both true correct", "Both true wrong"], correctAnswer: 2, year: 2025, chapter: "Sexual Reproduction Plants", classLevel: "12", topic: "Anther", solution: "Multinucleate nourishment." },

{ id: 55, question: "Ribosome correct statements:", options: ["ABE", "BDE", "ABC", "ABD"], correctAnswer: 2, year: 2025, chapter: "Cell Biology", classLevel: "11", topic: "Ribosome", solution: "80S 60+40." },

{ id: 56, question: "Haem enzyme:", options: ["Succinate dehydrogenase", "Catalase", "RuBisCo", "Carbonic anhydrase"], correctAnswer: 1, year: 2025, chapter: "Respiration", classLevel: "11", topic: "Enzyme", solution: "Catalase haem." },

{ id: 57, question: "Deoxygenated blood vessel frog:", options: ["Pulmonary vein", "Vena cava", "Aorta", "Pulmonary artery"], correctAnswer: 1, year: 2025, chapter: "Structural Organisation Animals", classLevel: "11", topic: "Frog circulation", solution: "Vena cava." },

{ id: 58, question: "Pteridophyte life cycle sequence:", options: ["DECA B", "EDCBA", "BADEC", "BAECD"], correctAnswer: 2, year: 2025, chapter: "Plant Kingdom", classLevel: "11", topic: "Pteridophyte", solution: "Meiosis → prothallus." },

{ id: 59, question: "Blue white screening statements:", options: ["I true II false", "I false II true", "Both true", "Both false"], correctAnswer: 1, year: 2025, chapter: "Biotech Tools", classLevel: "12", topic: "Cloning", solution: "White recombinant." },

{ id: 60, question: "Microbes not household products:", options: ["CD", "CE", "AB", "AC"], correctAnswer: 3, year: 2025, chapter: "Microbes", classLevel: "12", topic: "Industrial microbes", solution: "Aspergillus & Trichoderma." },

{ id: 61, question: "RNAi silencing via:", options: ["tRNA", "Non comp ssRNA", "Comp dsRNA", "Inhibitory ssRNA"], correctAnswer: 2, year: 2025, chapter: "Biotech Applications", classLevel: "12", topic: "RNAi", solution: "dsRNA required." },

{ id: 62, question: "Complex II ETC:", options: ["Cytochrome c oxidase", "NADH dehydrogenase", "Cytochrome bc1", "Succinate dehydrogenase"], correctAnswer: 3, year: 2025, chapter: "Respiration", classLevel: "11", topic: "ETC", solution: "Complex II." },

{ id: 63, question: "Body cavity pseudocoelom:", options: ["Schizocoelomate", "Spongocoelomate", "Acoelomate", "Pseudocoelomate"], correctAnswer: 3, year: 2025, chapter: "Animal Kingdom", classLevel: "11", topic: "Coelom", solution: "Mesoderm only body wall." },

{ id: 64, question: "Floral formula statement:", options: ["I true II false", "I false II true", "Both true", "Both false"], correctAnswer: 1, year: 2025, chapter: "Morphology", classLevel: "11", topic: "Floral formula", solution: "Actinomorphic symbol." },

{ id: 65, question: "Energy flow ecosystem:", options: ["I true II false", "I false II true", "Both true", "Both false"], correctAnswer: 0, year: 2025, chapter: "Ecosystem", classLevel: "12", topic: "Energy flow", solution: "2nd law applies." },

{ id: 66, question: "Unit of productivity:", options: ["Kcal m-3", "(Kcal m-2)yr-1", "gm-2", "Kcal m-2"], correctAnswer: 1, year: 2025, chapter: "Ecosystem", classLevel: "12", topic: "Productivity", solution: "Per area per year." },

{ id: 67, question: "Aleurone layer:", options: ["Integument", "Aleurone layer", "Coleoptile", "Coleorhiza"], correctAnswer: 1, year: 2025, chapter: "Anatomy Plants", classLevel: "11", topic: "Seed", solution: "Protein rich layer." },

{ id: 68, question: "Pigment match:", options: ["a", "b", "c", "d"], correctAnswer: 3, year: 2025, chapter: "Photosynthesis", classLevel: "11", topic: "Pigments", solution: "Chl a blue green." },

{ id: 69, question: "Triplet code proposed by:", options: ["Jacque Monod", "Franklin Stahl", "George Gamow", "Francis Crick"], correctAnswer: 2, year: 2025, chapter: "Molecular Basis", classLevel: "12", topic: "Genetic code", solution: "Gamow hypothesis." },

{ id: 70, question: "Histones enriched with:", options: ["Phe Leu", "Phe Arg", "Lys Arg", "Leu Lys"], correctAnswer: 2, year: 2025, chapter: "Molecular Basis", classLevel: "12", topic: "Chromatin", solution: "Basic amino acids." },

{ id: 71, question: "Gene cloning non essential:", options: ["DE", "BC", "CD", "AB"], correctAnswer: 2, year: 2025, chapter: "Biotech Tools", classLevel: "12", topic: "Cloning enzymes", solution: "Mutase recombinase not essential." },

{ id: 72, question: "Mesosome function structure:", options: ["Cristae", "ER", "Mesosome", "Chromatophore"], correctAnswer: 2, year: 2025, chapter: "Cell Biology", classLevel: "11", topic: "Prokaryotic cell", solution: "Membranous infolding." }
            ))
        ];

        const Icon = ({ name, size = 24, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (window.lucide && name && iconRef.current) {
                    iconRef.current.innerHTML = `<i data-lucide="${name}" stroke-width="2.5" style="width:${size}px; height:${size}px;" class="${className}"></i>`;
                    window.lucide.createIcons();
                }
            }, [name, size, className]);
            return <span ref={iconRef} className="inline-flex items-center"></span>;
        };

        function App() {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);
            const [history, setHistory] = useState([]);
            const [view, setView] = useState('home');
            const [darkMode, setDarkMode] = useState(true);
            const [showProfile, setShowProfile] = useState(false);
            const [filters, setFilters] = useState({ classLevel: "All", chapter: "All Chapters", startYear: 2010, endYear: 2025 });
            const [session, setSession] = useState({ questions: [], currentIndex: 0, userAnswers: {}, startTime: null });
            const [reviewFilter, setReviewFilter] = useState('all');

            const authRef = useRef(null);
            const dbRef = useRef(null);

            // Authentication & Back Button Handler
            useEffect(() => {
                const initFirebase = setInterval(() => {
                    if (window.FirebaseAPI) {
                        const api = window.FirebaseAPI;
                        const app = api.initializeApp(firebaseConfig);
                        authRef.current = api.getAuth(app);
                        dbRef.current = api.getFirestore(app);
                        api.onAuthStateChanged(authRef.current, (u) => {
                            setUser(u);
                            setLoading(false);
                        });
                        clearInterval(initFirebase);
                    }
                }, 100);

                const handleBack = (e) => {
                    if (e.state && e.state.view) setView(e.state.view);
                    else setView('home');
                };
                window.addEventListener('popstate', handleBack);
                return () => window.removeEventListener('popstate', handleBack);
            }, []);

            const navigate = (v) => { if (v !== view) { window.history.pushState({ view: v }, ''); setView(v); } };

            // Login with Google
            const handleGoogleLogin = async () => {
                if (!window.FirebaseAPI) return;
                const { GoogleAuthProvider, signInWithPopup } = window.FirebaseAPI;
                const provider = new GoogleAuthProvider();
                try {
                    await signInWithPopup(authRef.current, provider);
                } catch (error) {
                    console.error("Login failed", error);
                }
            };

            // History Sync (Rule 1 & 2)
            useEffect(() => {
                if (!user || !dbRef.current) return;
                const path = window.FirebaseAPI.collection(dbRef.current, 'artifacts', 'tejas-neet-bio-pyq', 'users', user.uid, 'history');
                return window.FirebaseAPI.onSnapshot(path, (snap) => {
                    const data = snap.docs.map(d => ({ id: d.id, ...d.data() }));
                    setHistory(data.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0)));
                });
            }, [user]);

            useEffect(() => { document.documentElement.classList.toggle('dark', darkMode); }, [darkMode]);

            const availableChapters = useMemo(() => filters.classLevel === "All" ? ALL_CHAPTER_LIST : ["All Chapters", ...CHAPTER_DATA[filters.classLevel]], [filters.classLevel]);

            const startPractice = () => {
                const filtered = ALL_QUESTIONS.filter(q => {
                    const cL = filters.classLevel === "All" || q.classLevel === filters.classLevel;
                    const cH = filters.chapter === "All Chapters" || q.chapter === filters.chapter;
                    const yR = q.year >= filters.startYear && q.year <= filters.endYear;
                    return cL && cH && yR;
                });
                if (filtered.length === 0) return alert("Selection empty!");
                setSession({ questions: filtered, currentIndex: 0, userAnswers: {}, startTime: Date.now() });
                navigate('practice');
            };

            const finishPractice = async () => {
                const totalTime = Math.floor((Date.now() - session.startTime) / 1000);
                const att = Object.keys(session.userAnswers).length;
                const cor = Object.values(session.userAnswers).filter(a => a.isCorrect).length;
                const stats = {
                    score: (cor * 4) - (att - cor), accuracy: att > 0 ? Math.round((cor / att) * 100) : 0,
                    timestamp: window.FirebaseAPI.serverTimestamp(), chapter: filters.chapter, classLevel: filters.classLevel, totalTime
                };
                navigate('report');
                if (user && dbRef.current) {
                    await window.FirebaseAPI.addDoc(window.FirebaseAPI.collection(dbRef.current, 'artifacts', 'tejas-neet-bio-pyq', 'users', user.uid, 'history'), stats);
                }
            };

            if (loading) return (
                <div className="min-h-screen flex items-center justify-center bg-slate-950">
                    <div className="w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
                </div>
            );

            // AUTH WALL: Only show if user is NOT logged in
            if (!user) return (
                <div className="min-h-screen flex flex-col items-center justify-center p-6 bg-slate-50 dark:bg-slate-950">
                    <div className="w-full max-w-md p-8 bg-white dark:bg-slate-900 rounded-[3rem] shadow-2xl border dark:border-slate-800 text-center">
                        <div className="inline-flex p-5 bg-indigo-100 dark:bg-indigo-900/30 rounded-3xl mb-6 text-indigo-600">
                            <Icon name="award" size={48} />
                        </div>
                        <h1 className="text-4xl font-black dark:text-white mb-2 tracking-tight">TEJAS <span className="text-indigo-500">NEET</span></h1>
                        <p className="text-slate-500 dark:text-slate-400 mb-10 font-bold tracking-wide">Please sign in to preserve your progress</p>
                        <button onClick={handleGoogleLogin} className="w-full h-16 bg-white dark:bg-slate-800 border dark:border-slate-700 rounded-2xl flex items-center justify-center gap-4 text-lg font-black dark:text-white shadow-lg btn-active transition-all">
                            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/action/google.svg" className="w-6 h-6" />
                            Continue with Google
                        </button>
                        <p className="mt-8 text-xs text-slate-400 font-medium">Your data is secured by Firebase</p>
                    </div>
                </div>
            );

            const HomeView = () => (
                <div className="min-h-screen flex flex-col items-center justify-center p-4">
                    <div className="fixed top-6 left-6 z-50">
                        <button onClick={() => setShowProfile(true)} className="w-12 h-12 bg-white dark:bg-slate-900 rounded-2xl shadow-xl border dark:border-slate-800 text-indigo-500 flex items-center justify-center btn-active">
                            {user?.photoURL ? <img src={user.photoURL} className="w-8 h-8 rounded-lg" /> : <Icon name="user"/>}
                        </button>
                    </div>
                    <div className="fixed top-6 right-6 z-50">
                        <button onClick={() => setDarkMode(!darkMode)} className="p-3 bg-white dark:bg-slate-900 rounded-2xl shadow-xl border dark:border-slate-800 btn-active">{darkMode ? <Icon name="sun" className="text-amber-400" /> : <Icon name="moon" className="text-indigo-500" />}</button>
                    </div>
                    <div className="w-full max-w-md bg-white dark:bg-slate-900 rounded-[2.5rem] p-8 shadow-2xl border dark:border-slate-800">
                        <div className="text-center mb-10">
                            <div className="inline-flex p-4 bg-indigo-100 dark:bg-indigo-900/30 rounded-2xl mb-4 text-indigo-600"><Icon name="book-open" size={42} /></div>
                            <h1 className="text-4xl font-black dark:text-white mb-1">TEJAS <span className="text-indigo-500">BIO PYQ</span></h1>
                            <p className="text-slate-400 font-bold uppercase tracking-widest text-[9px]">Hello, {user.displayName?.split(' ')[0]}</p>
                        </div>
                        <div className="space-y-6">
                            <div><label className="text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-2 px-1">Class</label><div className="grid grid-cols-3 gap-2">{["All", "11", "12"].map(l => (<button key={l} onClick={() => setFilters({...filters, classLevel: l})} className={`h-11 rounded-xl font-bold border ${filters.classLevel === l ? 'bg-indigo-600 border-indigo-600 text-white shadow-lg' : 'bg-slate-50 dark:bg-slate-800 dark:text-slate-400 border-slate-200 dark:border-slate-700'}`}>{l === "All" ? "Both" : `Class ${l}`}</button>))}</div></div>
                            <div><label className="text-[10px] font-black text-slate-400 uppercase block mb-2 px-1">Chapter</label><select value={filters.chapter} onChange={e => setFilters({...filters, chapter: e.target.value})} className="w-full h-12 bg-slate-50 dark:bg-slate-800 rounded-xl px-4 font-bold dark:text-white border dark:border-slate-700">{availableChapters.map(c => <option key={c} value={c}>{c}</option>)}</select></div>
                            <div className="grid grid-cols-2 gap-4">
                                <div><label className="text-[10px] font-black text-slate-400 uppercase block mb-1 px-1">From</label><select value={filters.startYear} onChange={e => setFilters({...filters, startYear: parseInt(e.target.value)})} className="w-full h-11 bg-slate-50 dark:bg-slate-800 rounded-xl px-3 font-bold dark:text-white border dark:border-slate-700">{YEAR_RANGE.map(y => <option key={y} value={y}>{y}</option>)}</select></div>
                                <div><label className="text-[10px] font-black text-slate-400 uppercase block mb-1 px-1">To</label><select value={filters.endYear} onChange={e => setFilters({...filters, endYear: parseInt(e.target.value)})} className="w-full h-11 bg-slate-50 dark:bg-slate-800 rounded-xl px-3 font-bold dark:text-white border dark:border-slate-700">{YEAR_RANGE.map(y => <option key={y} value={y}>{y}</option>)}</select></div>
                            </div>
                            <button onClick={startPractice} className="w-full py-4 bg-indigo-600 text-white rounded-2xl font-black text-lg shadow-xl active:scale-95 transition-all flex items-center justify-center gap-2 mt-2"><Icon name="play" size={20} /> START PRACTICE</button>
                        </div>
                    </div>
                </div>
            );

            const PracticeView = () => {
                const q = session.questions[session.currentIndex];
                const ua = session.userAnswers[q?.id];
                if (!q) return null;
                const progress = ((session.currentIndex + 1) / session.questions.length) * 100;
                return (
                    <div className="min-h-screen flex flex-col bg-slate-50 dark:bg-slate-950">
                        <div className="h-16 px-4 bg-white/90 dark:bg-slate-900/90 backdrop-blur-md border-b dark:border-slate-800 flex items-center justify-between sticky top-0 z-10">
                            <button onClick={() => window.history.back()} className="p-2 text-slate-400"><Icon name="arrow-left" size={24} /></button>
                            <div className="text-center"><p className="text-[10px] font-black text-indigo-500 uppercase truncate max-w-[150px]">{q.chapter}</p><p className="text-sm font-bold dark:text-white">Q {session.currentIndex + 1}/{session.questions.length}</p></div>
                            <button onClick={finishPractice} className="px-3 py-1 bg-red-500 text-white rounded-lg text-[10px] font-black uppercase">Finish</button>
                        </div>
                        <div className="w-full h-1.5 bg-slate-200 dark:bg-slate-800"><div className="h-full bg-indigo-500 transition-all duration-300" style={{ width: `${progress}%` }} /></div>
                        <div className="flex-1 max-w-3xl mx-auto w-full p-4 pb-32 overflow-y-auto no-scrollbar">
                            <div className="bg-white dark:bg-slate-900 rounded-[2.5rem] p-8 shadow-sm border dark:border-slate-800 mb-6 question-card">
                                <span className="px-3 py-1 bg-indigo-100 dark:bg-indigo-900/40 text-indigo-600 text-[10px] font-black rounded-full mb-4 inline-block uppercase">NEET {q.year}</span>
                                <h2 className="text-xl font-bold dark:text-white leading-relaxed mb-8">{q.question}</h2>
                                <div className="space-y-3">
                                    {q.options.map((opt, i) => {
                                        const isCor = i === q.correctAnswer;
                                        const isSel = ua?.selectedIndex === i;
                                        let style = "bg-slate-50 dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400";
                                        if (ua) {
                                            if (isCor) style = "bg-green-100 dark:bg-green-900/20 border-green-500 text-green-700 dark:text-green-400 ring-2 ring-green-500";
                                            else if (isSel) style = "bg-red-100 dark:bg-red-900/20 border-red-500 text-red-700 dark:text-red-400 ring-2 ring-red-500";
                                        }
                                        return (
                                            <button key={i} disabled={!!ua} onClick={() => setSession(p => ({ ...p, userAnswers: { ...p.userAnswers, [q.id]: { selectedIndex: i, isCorrect: i === q.correctAnswer } } }))} className={`w-full p-5 rounded-3xl flex items-center border text-left btn-active ${style}`}>
                                                <span className="w-8 h-8 rounded-full bg-black/5 dark:bg-white/5 flex items-center justify-center font-black mr-4">{String.fromCharCode(65 + i)}</span>
                                                <span className="font-bold flex-1">{opt}</span>
                                                {ua && isCor && <Icon name="check-circle" size={20} className="text-green-500 ml-2" />}
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>
                            {ua && <div className="p-6 bg-indigo-50 dark:bg-indigo-900/20 rounded-3xl border dark:border-indigo-800 text-sm"><p className="text-[10px] font-black text-indigo-500 uppercase mb-2">Detailed NCERT Solution:</p><p className="dark:text-slate-300 italic">{q.solution}</p></div>}
                        </div>
                        <div className="fixed bottom-0 left-0 right-0 p-4 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-t dark:border-slate-800 flex gap-4">
                            <button disabled={session.currentIndex === 0} onClick={() => setSession(p => ({...p, currentIndex: p.currentIndex - 1}))} className="flex-1 py-4 bg-slate-100 dark:bg-slate-800 dark:text-white rounded-2xl font-black text-xs disabled:opacity-30">PREV</button>
                            <button onClick={() => session.currentIndex < session.questions.length - 1 ? setSession(p => ({...p, currentIndex: p.currentIndex + 1})) : finishPractice()} className="flex-[2] py-4 bg-indigo-600 text-white rounded-2xl font-black text-xs shadow-lg active:scale-95 transition-all">{session.currentIndex === session.questions.length - 1 ? "FINISH" : (ua ? "NEXT" : "SKIP")}</button>
                        </div>
                    </div>
                );
            };

            const ReportView = () => {
                const att = Object.keys(session.userAnswers).length;
                const cor = Object.values(session.userAnswers).filter(a => a.isCorrect).length;
                const acc = att > 0 ? Math.round((cor / att) * 100) : 0;
                return (
                    <div className="min-h-screen p-6 flex flex-col items-center bg-slate-50 dark:bg-slate-950">
                        <div className="w-full max-w-xl space-y-6">
                            <div className="flex justify-between items-center"><h2 className="text-3xl font-black dark:text-white">Results</h2><button onClick={() => navigate('home')} className="p-3 bg-white dark:bg-slate-900 rounded-2xl border dark:border-slate-800 dark:text-white hover:scale-105 btn-active transition-all"><Icon name="rotate-ccw" size={20}/></button></div>
                            <div className="bg-gradient-to-br from-indigo-600 to-violet-700 p-10 rounded-[3rem] text-white shadow-2xl text-center relative overflow-hidden">
                                <p className="text-[10px] font-black uppercase opacity-70 tracking-widest">Final NEET Score</p>
                                <h3 className="text-8xl font-black my-4 tabular-nums">{(cor * 4) - (att - cor)}</h3>
                                <div className="grid grid-cols-2 mt-8 pt-8 border-t border-white/20">
                                    <div><p className="text-[10px] font-black uppercase opacity-70">Accuracy</p><p className="text-3xl font-black">{acc}%</p></div>
                                    <div><p className="text-[10px] font-black uppercase opacity-70">Attempted</p><p className="text-3xl font-black">{att}</p></div>
                                </div>
                            </div>
                            <button onClick={() => navigate('review')} className="w-full py-5 bg-white dark:bg-slate-900 border dark:border-slate-800 rounded-2xl font-black dark:text-white shadow-xl flex items-center justify-center gap-3 active:scale-95 transition-all"><Icon name="eye" size={22} /> VIEW QUESTIONS</button>
                        </div>
                    </div>
                );
            };

            const ReviewView = () => {
                const list = session.questions.filter(q => {
                    const ua = session.userAnswers[q.id];
                    if (reviewFilter === 'correct') return ua?.isCorrect;
                    if (reviewFilter === 'incorrect') return ua && !ua.isCorrect;
                    if (reviewFilter === 'skipped') return !ua;
                    return true;
                });
                return (
                    <div className="min-h-screen flex flex-col bg-slate-50 dark:bg-slate-950">
                        <div className="h-16 px-4 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b dark:border-slate-800 flex items-center gap-4 sticky top-0 z-20">
                            <button onClick={() => window.history.back()} className="p-2 dark:text-white"><Icon name="arrow-left" size={28} /></button>
                            <h3 className="font-black dark:text-white uppercase tracking-widest text-sm">Review Portal</h3>
                        </div>
                        <div className="flex gap-2 p-3 bg-white dark:bg-slate-900 border-b dark:border-slate-800 overflow-x-auto no-scrollbar sticky top-16 z-10">
                            {['all', 'correct', 'incorrect', 'skipped'].map(f => (<button key={f} onClick={() => setReviewFilter(f)} className={`px-5 h-10 rounded-full text-[10px] font-black uppercase flex-shrink-0 transition-all ${reviewFilter === f ? 'bg-indigo-600 text-white shadow-lg' : 'bg-slate-100 dark:bg-slate-800 text-slate-400 border dark:border-slate-700'}`}>{f}</button>))}
                        </div>
                        <div className="flex-1 p-4 space-y-6 pb-20 overflow-y-auto no-scrollbar">
                            {list.map((q, i) => {
                                const ua = session.userAnswers[q.id];
                                return (
                                    <div key={i} className="bg-white dark:bg-slate-900 rounded-[2.5rem] border dark:border-slate-800 p-6 shadow-sm">
                                        <div className="flex justify-between items-center mb-6"><span className="text-[10px] font-black text-indigo-500 uppercase tracking-widest">NEET {q.year}</span><span className={`px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest ${!ua ? 'bg-slate-100 text-slate-500' : ua.isCorrect ? 'bg-green-100 text-green-600' : 'bg-red-100 text-red-600'}`}>{!ua ? 'Skipped' : ua.isCorrect ? 'Correct' : 'Incorrect'}</span></div>
                                        <p className="font-bold dark:text-white mb-8 text-lg leading-relaxed">{q.question}</p>
                                        <div className="space-y-3">
                                            {q.options.map((o, idx) => {
                                                const isCor = idx === q.correctAnswer;
                                                const isUa = ua?.selectedIndex === idx;
                                                let st = "bg-slate-50 dark:bg-slate-800 text-slate-400 border-transparent";
                                                if (isCor) st = "bg-green-50 dark:bg-green-900/20 border-green-500 text-green-700 dark:text-green-400 border-2 shadow-sm ring-1 ring-green-500";
                                                else if (isUa && !isCor) st = "bg-red-50 dark:bg-red-900/20 border-red-500 text-red-700 dark:text-red-400 border-2 shadow-sm ring-1 ring-red-500";
                                                return (<div key={idx} className={`p-5 rounded-3xl text-sm font-black border flex items-center gap-4 ${st}`}><span className="w-7 h-7 rounded-full bg-black/5 dark:bg-white/5 flex items-center justify-center text-[10px] font-black flex-shrink-0">{String.fromCharCode(65 + idx)}</span><span className="flex-1 font-bold">{o}</span>{isCor && <Icon name="check-circle" size={18} className="text-green-500" />}{isUa && !isCor && <Icon name="x-circle" size={18} className="text-red-500" />}</div>);
                                            })}
                                        </div>
                                        <div className="mt-8 pt-6 border-t dark:border-slate-800 text-sm italic font-medium text-slate-600 dark:text-slate-400 bg-slate-50 dark:bg-slate-800/50 p-5 rounded-2xl">{q.solution}</div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            };

            const ProfileModal = () => (
                <div className="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
                    <div className="w-full max-w-lg bg-white dark:bg-slate-900 rounded-[2.5rem] shadow-2xl overflow-hidden border dark:border-slate-800 flex flex-col max-h-[90vh]">
                        <div className="p-6 border-b dark:border-slate-800 flex items-center justify-between bg-slate-50 dark:bg-slate-900/50">
                            <div className="flex items-center gap-3">
                                <div className="w-14 h-14 bg-indigo-600 rounded-2xl flex items-center justify-center overflow-hidden border-2 border-indigo-500 shadow-lg">
                                    {user.photoURL ? <img src={user.photoURL} /> : <Icon name="user" size={28} className="text-white"/>}
                                </div>
                                <div className="min-w-0">
                                    <h2 className="text-xl font-black dark:text-white truncate">{user.displayName}</h2>
                                    <p className="text-[10px] font-mono text-slate-400 truncate">{user.email}</p>
                                </div>
                            </div>
                            <button onClick={() => setShowProfile(false)}><Icon name="x" size={24} className="dark:text-white" /></button>
                        </div>
                        <div className="flex-1 overflow-y-auto p-6 space-y-4 no-scrollbar">
                            <div className="grid grid-cols-2 gap-4">
                                <div className="p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-2xl border dark:border-slate-800 text-center"><p className="text-[10px] font-black text-indigo-500 uppercase tracking-widest">Sessions</p><p className="text-2xl font-black dark:text-white">{history.length}</p></div>
                                <div className="p-4 bg-green-50 dark:bg-green-900/20 rounded-2xl border dark:border-slate-800 text-center"><p className="text-[10px] font-black text-green-500 uppercase tracking-widest">High Score</p><p className="text-2xl font-black dark:text-white">{history.length > 0 ? Math.max(...history.map(h => h.score || 0)) : 0}</p></div>
                            </div>
                            <div className="space-y-2">
                                <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-widest px-1">Recent Performance</h3>
                                {history.length === 0 ? <p className="text-center py-10 text-slate-500 italic">No history found</p> : history.map((h, i) => (
                                    <div key={i} className="p-4 bg-slate-50 dark:bg-slate-800 rounded-2xl flex justify-between items-center border dark:border-slate-700 shadow-sm">
                                        <div className="truncate pr-4"><p className="text-xs font-bold dark:text-white truncate">{h.chapter}</p><p className="text-[10px] text-slate-400">{new Date(h.timestamp?.seconds * 1000).toLocaleDateString()} • {h.accuracy}% Acc.</p></div>
                                        <div className="text-right ml-4 font-black text-indigo-500">+{h.score}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                        <div className="p-6 border-t dark:border-slate-800">
                            <button onClick={() => { window.FirebaseAPI.signOut(authRef.current); setShowProfile(false); }} className="w-full py-4 text-red-500 font-bold bg-red-50 dark:bg-red-900/20 rounded-2xl active:scale-95 transition-all">Sign Out Account</button>
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen text-slate-900 dark:text-slate-100 selection:bg-indigo-500/30 overflow-hidden">
                    {showProfile && <ProfileModal />}
                    {view === 'home' && <HomeView />}
                    {view === 'practice' && <PracticeView />}
                    {view === 'report' && <ReportView />}
                    {view === 'review' && <ReviewView />}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

